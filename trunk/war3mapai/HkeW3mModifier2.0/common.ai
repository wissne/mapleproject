native DebugS               takes string str                            returns nothing
native DebugFI              takes string str, integer val               returns nothing
native DebugUnitID          takes string str, integer val               returns nothing
native DisplayText          takes integer p, string str                 returns nothing
native DisplayTextI         takes integer p, string str, integer val    returns nothing
native DisplayTextII        takes integer p, string str, integer v1, integer v2 returns nothing
native DisplayTextIII       takes integer p, string str, integer v1, integer v2, integer v3 returns nothing
native DoAiScriptDebug      takes nothing                               returns boolean

native GetAiPlayer          takes nothing                               returns integer
native GetHeroId            takes nothing                               returns integer
native GetHeroLevelAI       takes nothing                               returns integer

native GetUnitCount         takes integer unitid                        returns integer
native GetPlayerUnitTypeCount takes player p, integer unitid            returns integer
native GetUnitCountDone     takes integer unitid                        returns integer
native GetTownUnitCount     takes integer id, integer tn, boolean dn    returns integer
native GetUnitGoldCost      takes integer unitid                        returns integer
native GetUnitWoodCost      takes integer unitid                        returns integer
native GetUnitBuildTime     takes integer unitid                        returns integer

native GetMinesOwned        takes nothing                               returns integer
native GetGoldOwned         takes nothing                               returns integer
native TownWithMine         takes nothing                               returns integer
native TownHasMine          takes integer townid                        returns boolean
native TownHasHall          takes integer townid                        returns boolean

native GetUpgradeLevel      takes integer id                            returns integer
native GetUpgradeGoldCost   takes integer id                            returns integer
native GetUpgradeWoodCost   takes integer id                            returns integer
native GetNextExpansion     takes nothing                               returns integer
native GetMegaTarget        takes nothing                               returns unit
native GetBuilding          takes player p                              returns unit
native GetEnemyPower        takes nothing                               returns integer
native SetAllianceTarget    takes unit id                               returns nothing
native GetAllianceTarget    takes nothing                               returns unit

native SetProduce           takes integer qty, integer id, integer town returns boolean
native Unsummon             takes unit unitid                           returns nothing
native SetExpansion         takes unit peon, integer id                 returns boolean
native SetUpgrade           takes integer id                            returns boolean
native SetHeroLevels        takes code func                             returns nothing
native SetNewHeroes         takes boolean state                         returns nothing
native PurchaseZeppelin     takes nothing                               returns nothing

native MergeUnits           takes integer qty, integer a, integer b, integer make returns boolean
native ConvertUnits         takes integer qty, integer id               returns boolean

native SetCampaignAI        takes nothing                               returns nothing
native SetMeleeAI           takes nothing                               returns nothing
native SetTargetHeroes      takes boolean state                         returns nothing
native SetPeonsRepair       takes boolean state                         returns nothing
native SetRandomPaths       takes boolean state                         returns nothing
native SetDefendPlayer      takes boolean state                         returns nothing
native SetHeroesFlee        takes boolean state                         returns nothing
native SetHeroesBuyItems    takes boolean state                         returns nothing
native SetWatchMegaTargets  takes boolean state                         returns nothing
native SetIgnoreInjured     takes boolean state                         returns nothing
native SetHeroesTakeItems   takes boolean state                         returns nothing
native SetUnitsFlee         takes boolean state                         returns nothing
native SetGroupsFlee        takes boolean state                         returns nothing
native SetSlowChopping      takes boolean state                         returns nothing
native SetCaptainChanges    takes boolean allow                         returns nothing
native SetSmartArtillery    takes boolean state                         returns nothing
native SetReplacementCount  takes integer qty                           returns nothing
native GroupTimedLife       takes boolean allow                         returns nothing
native RemoveInjuries       takes nothing                               returns nothing
native RemoveSiege          takes nothing                               returns nothing

native InitAssault          takes nothing                               returns nothing
native AddAssault           takes integer qty, integer id               returns boolean
native AddDefenders         takes integer qty, integer id               returns boolean

native GetCreepCamp         takes integer min, integer max, boolean flyers_ok returns unit

native StartGetEnemyBase    takes nothing                               returns nothing
native WaitGetEnemyBase     takes nothing                               returns boolean
native GetEnemyBase         takes nothing                               returns unit
native GetExpansionFoe      takes nothing                               returns unit
native GetEnemyExpansion    takes nothing                               returns unit
native GetExpansionX        takes nothing                               returns integer
native GetExpansionY        takes nothing                               returns integer
native SetStagePoint        takes real x, real y                        returns nothing
native AttackMoveKill       takes unit target                           returns nothing
native AttackMoveXY         takes integer x, integer y                  returns nothing
native LoadZepWave          takes integer x, integer y                  returns nothing
native SuicidePlayer        takes player id, boolean check_full         returns boolean
native SuicidePlayerUnits   takes player id, boolean check_full         returns boolean
native CaptainInCombat      takes boolean attack_captain                returns boolean
native IsTowered            takes unit target                           returns boolean

native ClearHarvestAI       takes nothing                               returns nothing
native HarvestGold          takes integer town, integer peons           returns nothing
native HarvestWood          takes integer town, integer peons           returns nothing
native GetExpansionPeon     takes nothing                               returns unit

native StopGathering        takes nothing                               returns nothing
native AddGuardPost         takes integer id, real x, real y            returns nothing
native FillGuardPosts       takes nothing                               returns nothing
native ReturnGuardPosts     takes nothing                               returns nothing
native CreateCaptains       takes nothing                               returns nothing
native SetCaptainHome       takes integer which, real x, real y         returns nothing
native ResetCaptainLocs     takes nothing                               returns nothing
native ShiftTownSpot        takes real x, real y                        returns nothing
native TeleportCaptain      takes real x, real y                        returns nothing
native ClearCaptainTargets  takes nothing                               returns nothing
native CaptainAttack        takes real x, real y                        returns nothing
native CaptainVsUnits       takes player id                             returns nothing
native CaptainVsPlayer      takes player id                             returns nothing
native CaptainGoHome        takes nothing                               returns nothing
native CaptainIsHome        takes nothing                               returns boolean
native CaptainIsFull        takes nothing                               returns boolean
native CaptainIsEmpty       takes nothing                               returns boolean
native CaptainGroupSize     takes nothing                               returns integer
native CaptainReadiness     takes nothing                               returns integer
native CaptainRetreating    takes nothing                               returns boolean
native CaptainReadinessHP   takes nothing                               returns integer
native CaptainReadinessMa   takes nothing                               returns integer
native CaptainAtGoal        takes nothing                               returns boolean
native CreepsOnMap          takes nothing                               returns boolean
native SuicideUnit          takes integer count, integer unitid         returns nothing
native SuicideUnitEx        takes integer ct, integer uid, integer pid  returns nothing
native StartThread          takes code func                             returns nothing
native Sleep                takes real seconds                          returns nothing
native UnitAlive            takes unit id                               returns boolean
native UnitInvis            takes unit id                               returns boolean
native IgnoredUnits         takes integer unitid                        returns integer
native TownThreatened       takes nothing                               returns boolean
native DisablePathing       takes nothing                               returns nothing
native SetAmphibious        takes nothing                               returns nothing

native CommandsWaiting      takes nothing                               returns integer
native GetLastCommand       takes nothing                               returns integer
native GetLastData          takes nothing                               returns integer
native PopLastCommand       takes nothing                               returns nothing
native MeleeDifficulty      takes nothing                               returns integer
globals
    player  ai_player = null
    string message_add = ""
    sound chatSound = CreateSound( "Sound\\Interface\\InGameChatWhat1.wav", false, false, false, 10, 10, "" )
    sound importantSound = CreateSound( "Sound\\Interface\\CreepAggroWhat1.wav", false, false, false, 10, 10, "" )
    constant real      bj_PI                            = 3.14159
    constant real      bj_RADTODEG                      = 180.0/bj_PI
    
    
    integer hid_zhugeliang='H008'
    integer hid_zhaoyun='E000'
    integer hid_guanyu='O003'
    integer hid_zhangfei='O002'
    integer hid_weiyan='H004'
    
    integer hid_simayi='U00A'
    integer hid_guojia='U000'
    integer hid_caoren='U007'
    integer hid_dianwei='H006'
    integer hid_xun='U00I'
    integer hid_zhangliao='H005'
    
    /////////////
    integer uid_XiaLuMutong='hgtw'
    integer uid_ShangLuMutong='hwtw'
    
    integer iid_zhanshenfu='tstr'
    integer iid_zhanshenkai='tst2'
    integer iid_tianxue='rspd'
    integer iid_laojiu='pgma'
    integer iid_roubao='shrs'
    
    //////////////
    integer mGold=0
    integer lumber=0
    
    location suguoBaseLoc=Location(-6600,-7800)
    location weiguoBaseLoc=Location(6000,7000)
    location zs_He_middle=Location(-850,-780)
    location zs_xialu_yinbingLoc=Location(704,-5260)
    location zs_xialu_yinbingLoc2=Location(540,-4955)
    location zs_xialu_yinbingLoc3=Location(737,-7523)
    
    rect zs_xialu_yinbingRect=Rect(-2300,-7490,-1500,-6566)
    location zs_xialu_yinbingLoc4=Location(-1682,-6942)
    
    
    location zs_xialu_WeiGuoyinbingLoc=Location(4250,-688)
    location zs_xialu_WeiGuoyinbingLoc2=Location(6600,-688)
    
    location zs_xialu_mutong=Location(2900,-3100)
    boolean isdebug=false
    integer MaxSlot=6
    integer bj_MAX_PLAYER_SLOTS=12
    integer bj_groupEnumTypeId=0
    string array digit_str
    
    location zs_middleline_loc1
    location zs_middleline_loc2
    location zs_middleline_loc3
    location zs_middleline_loc4
    
    unit mHero =null
    unit zs_mutong=null
    
    /////////////////////
    boolean zs_dubingZhonglu=true
    boolean zs_suguoyinbing=true
    boolean zs_weiguoyinbing=true
    //////////////////////
    
    
    
    //////////////////
    location array zs_path_middle
    location array zs_path_shanglu
    location array zs_path_xialu
    
    //////////
    
    location mBaseLoc=null
    location mEnemyBaseLoc =null
    location mdubingLoc=null
    location zs_dubing_cdt_loc=null
    location zs_cr_attackLoc=mEnemyBaseLoc
    location zs_xialu=Location(5100,-6600)
    location zs_shanglu=Location(-5500,6000)
    location zs_backloc
    location zs_forwardloc
    location zs_cr_retreatLoc
    
    
    integer zs_locindex=0
    
    
    integer mHeroId=0
    integer mForceId=0
    
    integer zs_cr_fightline=1  //0,1,2 上中下三路
    
    integer mUnitId=0
    integer ShopNearbyRange=300
    integer zs_dubingParam=260
    integer array mSkillArray
    real zs_budaoXieLiangBaseD=80
    real zs_budaoXieLiangBaseW=80
    real zs_attackrange=600
    real zs_budaoXieLiangD=90
    real zs_budaoXieLiangW=90
    real zs_budaoXieLiangW2=290
    real zs_budaoXieLiangD2=290
    real zs_chiyaoSafeRangetoEnemy=900
    real zs_SafeLocRangeToEnemyA=620
    real zs_SafeLocRangeToEnemy=620
    real zs_SafeLocRangeToTower=1100
    real zs_SafeLocRndParamDgree=120
    real zs_gardRange=1600
    real za_rect_range=1200
    item array HeroItems
    ////
    item tempDroped=null
    unit zs_buyitemtmpshop=null
    ////
    boolean bBuyItemFlag=true
    
    //
    unit zs_nearestMinHpAllyBing=null
    unit zs_nearestMinHpEnemyBing=null
    unit FarestAllyBubingFromRetreatLoc=null
    unit NearestEnemyBubingFromRetreatLoc=null
    
    ///////////////////////////temp min or max
    real zs_nearestAllyBingMinHp=999999
    real zs_nearestEnemyBingMinHp=999999
    real zs_nearestEnemyHeroMinRange=999999
    real zs_nearestEnemyTowerMinRange=999999
    real zs_nearestAllyTowerMinRange=999999
    real zs_nearestEnemyBingMinRange=999999
    real  zs_FarestAllyBingMaxRange=0
    real zs_FarestAllyBingFromRetreatLocMaxRange  =0
    real zs_NearestEnemyBingFromRetreatLocMinRange=9999999
    
    //////////////////////////////////////
    real zs_TmpPreEnemyBingHP=0
    real zs_TmpPreAllyBingHP=0
    real zs_SecondsEnemyBing=9999999
    real zs_SecondsAllyBing=9999999
    real zs_periodSeconds=0.5
    real zs_BingBaseTime=2.0
    real zs_BingTime=2.0
    
    real zs_myhero_preHP=999999
    real zs_myhero_hpchanged=0
endglobals



function zs_initPath takes nothing returns nothing
    if mForceId==1 then
        set zs_path_middle[0]=suguoBaseLoc
        set zs_path_middle[1]=Location(-4752,-5782)
        set zs_path_middle[2]=Location(-3300,-4100)
        set zs_path_middle[3]=Location(-2000,-2300)
        set zs_path_middle[4]=Location(-600,-350)
        set zs_path_middle[5]=Location(430,1000)
        set zs_path_middle[6]=Location(2000,2400)
        set zs_path_middle[7]=Location(3700,4300)
        set zs_path_middle[8]=Location(5400,5300)
        set zs_path_middle[9]=weiguoBaseLoc
        
        
        set zs_path_shanglu[0]=suguoBaseLoc
        set zs_path_shanglu[1]=Location(-6500,-4600)
        set zs_path_shanglu[2]=Location(-6200,-2000)
        set zs_path_shanglu[3]=Location(-6000,480)
        set zs_path_shanglu[4]=Location(-5900,2555)
        set zs_path_shanglu[5]=Location(-5500,5700)
        set zs_path_shanglu[6]=Location(-3500,6000)
        set zs_path_shanglu[7]=Location(-400,6000)
        set zs_path_shanglu[8]=Location(3300,5800)
        set zs_path_shanglu[9]=Location(5500,5500)
        set zs_path_shanglu[10]=weiguoBaseLoc
        
        set zs_path_xialu[0]=suguoBaseLoc
        set zs_path_xialu[1]=Location(-3300,-7000)
        set zs_path_xialu[2]=Location(-700,-6888)
        set zs_path_xialu[3]=Location(2000,-6900)
        set zs_path_xialu[4]=Location(5000,-6600)
        set zs_path_xialu[5]=Location(5500,-3000)
        set zs_path_xialu[6]=Location(5700,-690)
        set zs_path_xialu[7]=Location(5500,1390)
        set zs_path_xialu[8]=Location(5500,3700)
        set zs_path_xialu[9]=weiguoBaseLoc
        
    endif
    
    if mForceId==2 then
        
        set zs_path_middle[9]=suguoBaseLoc
        set zs_path_middle[8]=Location(-4752,-5782)
        set zs_path_middle[7]=Location(-3300,-4100)
        set zs_path_middle[6]=Location(-2000,-2300)
        set zs_path_middle[5]=Location(-600,-350)
        set zs_path_middle[4]=Location(430,1000)
        set zs_path_middle[3]=Location(2000,2400)
        set zs_path_middle[2]=Location(3700,4300)
        set zs_path_middle[1]=Location(5400,5300)
        set zs_path_middle[0]=weiguoBaseLoc
        
        
        set zs_path_shanglu[10]=suguoBaseLoc
        set zs_path_shanglu[9]=Location(-6500,-4600)
        set zs_path_shanglu[8]=Location(-6200,-2000)
        set zs_path_shanglu[7]=Location(-6000,480)
        set zs_path_shanglu[6]=Location(-5900,2555)
        set zs_path_shanglu[5]=Location(-5500,5700)
        set zs_path_shanglu[4]=Location(-3500,6000)
        set zs_path_shanglu[3]=Location(-400,6000)
        set zs_path_shanglu[2]=Location(3300,5800)
        set zs_path_shanglu[1]=Location(5500,5500)
        set zs_path_shanglu[0]=weiguoBaseLoc
        
        set zs_path_xialu[9]=suguoBaseLoc
        set zs_path_xialu[8]=Location(-3300,-7000)
        set zs_path_xialu[7]=Location(-700,-6888)
        set zs_path_xialu[6]=Location(2000,-6900)
        set zs_path_xialu[5]=Location(5000,-6600)
        set zs_path_xialu[4]=Location(5500,-3000)
        set zs_path_xialu[3]=Location(5700,-690)
        set zs_path_xialu[2]=Location(5500,1390)
        set zs_path_xialu[1]=Location(5500,3700)
        set zs_path_xialu[0]=weiguoBaseLoc
        
    endif
endfunction

function Handle2Int takes handle h returns integer
    return h
    return 0
endfunction



function DisplayToAll takes string s returns nothing
    call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
    call StartSound(chatSound)
endfunction

function DisplayToAllImportant takes string s returns nothing
    call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
    call StartSound(importantSound)
endfunction

function DisplayToAllies takes string s returns nothing
    if IsPlayerAlly(ai_player,GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(chatSound)
    endif
endfunction

function DisplayToAlliesImportant takes string s returns nothing
    if IsPlayerAlly(ai_player,GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(importantSound)
    endif
endfunction

function DisplayToEnemy takes string s returns nothing
    if IsPlayerEnemy(ai_player,GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(chatSound)
    endif
endfunction

function DisplayToEnemyImportant takes string s returns nothing
    if IsPlayerEnemy(ai_player,GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(importantSound)
    endif
endfunction

function DisplayToObservers takes string s returns nothing
    if IsPlayerObserver(GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(chatSound)
    endif
endfunction

function DisplayToObserversImportant takes string s returns nothing
    if IsPlayerObserver(GetLocalPlayer()) then
        call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,15,message_add+s)
        call StartSound(importantSound)
    endif
endfunction



function absolute takes integer a returns integer
    if a >= 0 then
        return a
    else
        return -a
    endif
endfunction

function r_absolute takes real a returns real
    if a >= 0 then
        return a
    else
        return -a
    endif
endfunction

function minimum takes integer a, integer b returns integer
    if a < b then
        return a
    else
        return b
    endif
endfunction

function r_minimum takes real a, real b returns real
    if a < b then
        return a
    else
        return b
    endif
endfunction

function maximum takes integer a, integer b returns integer
    if a > b then
        return a
    else
        return b
    endif
endfunction

function r_maximum takes real a, real b returns real
    if a > b then
        return a
    else
        return b
    endif
endfunction

function GetRandomDiff takes integer maxdiff returns integer
    if GetRandomInt(0,1) == 1 then
        return GetRandomInt(0,maxdiff)
    else
        return -GetRandomInt(0,maxdiff)
    endif
endfunction

function LinearInterpolation takes real x1, real x2, real y1, real y2, real p returns real
    if p <= x1 then
        return y1
    elseif p >= x2 then
        return y2
    else
        return y1 + ((p - x1)/(x2 - x1)) * (y2 - y1)
    endif
endfunction

function l_add_kk takes location l1, location l2 returns location
    return Location(GetLocationX(l1) + GetLocationX(l2), GetLocationY(l1) + GetLocationY(l2))
endfunction

function l_add_dk takes location l1, location l2 returns location
    call MoveLocation(l1, GetLocationX(l1) + GetLocationX(l2), GetLocationY(l1) + GetLocationY(l2))
    return l1
endfunction

function l_add_kd takes location l1, location l2 returns location
    call MoveLocation(l2, GetLocationX(l1) + GetLocationX(l2), GetLocationY(l1) + GetLocationY(l2))
    return l2
endfunction

function l_add_dd takes location l1, location l2 returns location
    call MoveLocation(l1, GetLocationX(l1) + GetLocationX(l2), GetLocationY(l1) + GetLocationY(l2))
    call RemoveLocation(l2)
    return l1
endfunction

function l_sub_kk takes location l1, location l2 returns location
    return Location(GetLocationX(l1) - GetLocationX(l2), GetLocationY(l1) - GetLocationY(l2))
endfunction

function l_sub_dk takes location l1, location l2 returns location
    call MoveLocation(l1, GetLocationX(l1) - GetLocationX(l2), GetLocationY(l1) - GetLocationY(l2))
    return l1
endfunction

function l_sub_kd takes location l1, location l2 returns location
    call MoveLocation(l2, GetLocationX(l1) - GetLocationX(l2), GetLocationY(l1) - GetLocationY(l2))
    return l2
endfunction

function l_sub_dd takes location l1, location l2 returns location
    call MoveLocation(l1, GetLocationX(l1) - GetLocationX(l2), GetLocationY(l1) - GetLocationY(l2))
    call RemoveLocation(l2)
    return l1
endfunction

function l_mult_k takes location l, real m returns location
    return Location(GetLocationX(l) * m, GetLocationY(l) * m)
endfunction

function l_mult_d takes location l, real m returns location
    call MoveLocation(l, GetLocationX(l) * m, GetLocationY(l) * m)
    return l
endfunction

function l_div_k takes location l, real d returns location
    return Location(GetLocationX(l) / d, GetLocationY(l) / d)
endfunction

function l_div_d takes location l, real d returns location
    call MoveLocation(l, GetLocationX(l) / d, GetLocationY(l) / d)
    return l
endfunction

function l_length_k takes location l returns real
    local real x = GetLocationX(l)
    local real y = GetLocationY(l)
    return SquareRoot(x * x + y * y)
endfunction

function l_length_d takes location l returns real
    local real x = GetLocationX(l)
    local real y = GetLocationY(l)
    call RemoveLocation(l)
    return SquareRoot(x * x + y * y)
endfunction

function l_norm_k takes location l returns location
    return l_div_k(l, l_length_k(l))
endfunction

function l_norm_d takes location l returns location
    return l_div_d(l, l_length_k(l))
endfunction

function l_project_kk takes location l, location v, real r returns location
    return l_add_kd(l, l_mult_d(l_norm_k(v), r))
endfunction

function l_project_dk takes location l, location v, real r returns location
    return l_add_dd(l, l_mult_d(l_norm_k(v), r))
endfunction

function l_project_kd takes location l, location v, real r returns location
    return l_add_kd(l, l_mult_d(l_norm_d(v), r))
endfunction

function l_project_dd takes location l, location v, real r returns location
    return l_add_dd(l, l_mult_d(l_norm_d(v), r))
endfunction

function l_smult_kk takes location l1, location l2 returns real
    return GetLocationX(l1) * GetLocationX(l2) + GetLocationY(l1) * GetLocationY(l2)
endfunction

function l_smult_dk takes location l1, location l2 returns real
    local real ret = GetLocationX(l1) * GetLocationX(l2) + GetLocationY(l1) * GetLocationY(l2)
    call RemoveLocation(l1)
    return ret
endfunction

function l_smult_kd takes location l1, location l2 returns real
    local real ret = GetLocationX(l1) * GetLocationX(l2) + GetLocationY(l1) * GetLocationY(l2)
    call RemoveLocation(l2)
    return ret
endfunction

function l_smult_dd takes location l1, location l2 returns real
    local real ret = GetLocationX(l1) * GetLocationX(l2) + GetLocationY(l1) * GetLocationY(l2)
    call RemoveLocation(l1)
    call RemoveLocation(l2)
    return ret
endfunction

function l_angle_kk takes location l1, location l2 returns real
    return Acos(l_smult_kk(l1, l2) / (l_length_k(l1) * l_length_k(l2)))
endfunction

function l_angle_dk takes location l1, location l2 returns real
    return Acos(l_smult_kk(l1, l2) / (l_length_d(l1) * l_length_k(l2)))
endfunction

function l_angle_kd takes location l1, location l2 returns real
    return Acos(l_smult_kk(l1, l2) / (l_length_k(l1) * l_length_d(l2)))
endfunction

function l_angle_dd takes location l1, location l2 returns real
    return Acos(l_smult_kk(l1, l2) / (l_length_d(l1) * l_length_d(l2)))
endfunction


function GetGold takes nothing returns integer
    return GetPlayerState(ai_player,PLAYER_STATE_RESOURCE_GOLD)
endfunction

function GetWood takes nothing returns integer
    return GetPlayerState(ai_player,PLAYER_STATE_RESOURCE_LUMBER)
endfunction


function SetPlayerGold takes player p, integer i returns nothing
    call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,i)
endfunction

function SetPlayerWood takes player p, integer i returns nothing
    call SetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER,i)
endfunction

function IncreasePlayerGold takes player p, integer i returns nothing
    call SetPlayerGold(p, GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD) + i)
endfunction

function IncreasePlayerWood takes player p, integer i returns nothing
    call SetPlayerWood(p, GetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER) + i)
endfunction


function GetSlotsFreeOnUnit takes unit u returns integer
    local integer i = 0
    local integer sum = 0
    loop
        exitwhen i > 5
        if UnitItemInSlot(u, i) == null then
            set sum = sum + 1
        endif
        set i = i + 1
    endloop
    return sum
endfunction





//ddddddddddddd



function debugstr takes string s returns nothing
    if isdebug then
        call DisplayToAll(s)
    endif
endfunction

function intd_str takes nothing returns nothing
    set digit_str[0]="0"
    set digit_str[1]="1"
    set digit_str[2]="2"
    set digit_str[3]="3"
    set digit_str[4]="4"
    set digit_str[5]="5"
    set digit_str[6]="6"
    set digit_str[7]="7"
    set digit_str[8]="8"
    set digit_str[9]="9"
    
    //return
endfunction



function ITS takes integer ic returns string
    local string s = ""
    local integer i = ic
    local integer ialt = 0
    local boolean neg = false
    
    if i == 0 then
        return "0"
    endif
    if i < 0 then
        set neg = true
        set i = -i
    endif
    loop
        exitwhen i == 0
        set ialt = i
        set i = i / 10
        set s = digit_str[ ialt - 10*i ] + s
    endloop
    if neg then
        return "-"+s
    endif
    return s
endfunction














function IsUnitDeadBJ takes unit whichUnit returns boolean
    return GetUnitState(whichUnit, UNIT_STATE_LIFE) <= 0
endfunction
function IsDead takes unit TheUnit returns boolean
    return(TheUnit==null)or(IsUnitType(TheUnit,UNIT_TYPE_DEAD))or(IsUnitDeadBJ(TheUnit))
endfunction
function IsAlive takes unit TheUnit returns boolean
    return(TheUnit!=null)and(IsDead(TheUnit)==false)
endfunction


function GetUnitLocLevel takes unit TheUnit returns integer
    local integer TheLvl=0
    if(TheUnit!=null)and(IsAlive(TheUnit))then
        set TheLvl=(GetTerrainCliffLevel(GetUnitX(TheUnit),GetUnitY(TheUnit)))
    endif
    return TheLvl
endfunction
function AngleBetweenPoints takes location locA, location locB returns real
    return bj_RADTODEG * Atan2(GetLocationY(locB) - GetLocationY(locA), GetLocationX(locB) - GetLocationX(locA))
endfunction
function IsBackFacing takes unit TheUnit,unit TheTarget returns boolean
    local real TheDir
    local location UnitLoc
    local location TargetLoc
    local real TargetDir
    local real tmpval
    if(TheUnit!=null)and(TheTarget!=null)and(IsAlive(TheUnit))and(IsAlive(TheTarget))then
        set TheDir=GetUnitFacing(TheUnit)
        set UnitLoc=GetUnitLoc(TheUnit)
        set TargetLoc=GetUnitLoc(TheTarget)
        set TargetDir=AngleBetweenPoints(UnitLoc,TargetLoc)
        call RemoveLocation(TargetLoc)
        call RemoveLocation(UnitLoc)
        if TheDir>=TargetDir then
            set tmpval=TheDir-TargetDir
        else
            set tmpval=TargetDir-TheDir
        endif
        if(tmpval>=150)and(tmpval<=210)then
            return(true)
        endif
    endif
    return(false)
endfunction
function RangeLocToLoc takes location TheStart,location TheTarget returns real
    local real TheXRange
    local real TheYRange
    set TheXRange=GetLocationX(TheTarget)-GetLocationX(TheStart)
    set TheXRange=TheXRange*TheXRange
    set TheYRange=GetLocationY(TheTarget)-GetLocationY(TheStart)
    set TheYRange=TheYRange*TheYRange
    return(SquareRoot(TheXRange+TheYRange))
endfunction

function debugLoc takes location loc,integer id returns nothing
    local effect fx
    if not isdebug then
        return
    endif
    if id==1 then
        set fx=AddSpecialEffectLoc("Abilities\\Spells\\Other\\Monsoon\\MonsoonBoltTarget.mdl",loc)
    endif
    if id==2 then
        set fx=AddSpecialEffectLoc("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",loc)
    endif
    if id==3 then
        set fx=AddSpecialEffectLoc("Abilities\\Spells\\Orc\\Reincarnation\\ReincarnationTarget.mdl",loc)
    endif
    
    call DestroyEffect(fx)
    //return
endfunction
function HeroStop takes unit u  returns boolean
    return  IssueImmediateOrder( u, "stop" )
endfunction

function Abs takes real TheValue returns real
    if TheValue<0 then
        return(-TheValue)
    else
        return(TheValue)
    endif
endfunction

function middleLocBetweenTwoLoc takes location loc1,location loc2 returns location
    return Location((GetLocationX(loc1)+GetLocationX(loc2))/2,(GetLocationY(loc1)+GetLocationY(loc2))/2)
endfunction
function middleLocBetweenTwoUnit takes unit u1,unit u2 returns location
    return Location((GetUnitX(u1)+GetUnitX(u2))/2,(GetUnitY(u1)+GetUnitY(u2))/2)
endfunction
function RangeToLine takes location LineStart,location LineEnd,location ThePoint returns real
    local real dX
    local real dY
    local real TheRange
    set dX=GetLocationX(LineEnd)-GetLocationX(LineStart)
    set dY=GetLocationY(LineEnd)-GetLocationY(LineStart)
    set TheRange=SquareRoot((dX*dX)+(dY*dY))
    if TheRange==0 then
        set TheRange=RangeLocToLoc(LineStart,ThePoint)
    else
        set TheRange=Abs((dY*GetLocationX(ThePoint))+((-dX)*GetLocationY(ThePoint)))/TheRange
    endif
    return(TheRange)
endfunction


function isUnitInRect takes unit TheUnit,location loc1,location loc2,location loc3,location loc4 returns boolean
    local boolean rb=false
    local location theLoc=null
    local real range1=RangeLocToLoc(loc1,loc2)
    local real range2=RangeLocToLoc(loc1,loc4)
    if (TheUnit==null or not IsAlive(TheUnit)) then
        return false
    endif
    set theLoc=GetUnitLoc(TheUnit)
    set rb= RangeToLine(loc1,loc2,theLoc)<range2 and  RangeToLine(loc3,loc4,theLoc)<range2
    set rb=rb and RangeToLine(loc2,loc3,theLoc)<range1 and  RangeToLine(loc1,loc4,theLoc)<range1
    call RemoveLocation(theLoc)
    set theLoc=null
    return rb
endfunction



function RangeToLoc takes unit TheUnit,location TheTarget returns real
    local real TheXRange
    local real TheYRange
    if(TheUnit!=null)and(IsAlive(TheUnit))then
        set TheXRange=GetLocationX(TheTarget)-GetUnitX(TheUnit)
        set TheXRange=TheXRange*TheXRange
        set TheYRange=GetLocationY(TheTarget)-GetUnitY(TheUnit)
        set TheYRange=TheYRange*TheYRange
        return(SquareRoot(TheXRange+TheYRange))
    endif
    return 0.
endfunction
function RangeTo takes unit TheUnit,unit TheTarget returns real
    local real TheXRange
    local real TheYRange
    if(TheUnit!=null)and(TheTarget!=null)and(IsAlive(TheUnit))and(IsAlive(TheTarget))then
        set TheXRange=GetUnitX(TheTarget)-GetUnitX(TheUnit)
        set TheXRange=TheXRange*TheXRange
        set TheYRange=GetUnitY(TheTarget)-GetUnitY(TheUnit)
        set TheYRange=TheYRange*TheYRange
        return(SquareRoot(TheXRange+TheYRange))
    endif
    return 0.
endfunction
function RangeToItem takes unit TheUnit,item TheTarget returns real
    local real TheXRange
    local real TheYRange
    if(TheUnit!=null)and(TheTarget!=null)and(IsAlive(TheUnit))then
        set TheXRange=GetItemX(TheTarget)-GetUnitX(TheUnit)
        set TheXRange=TheXRange*TheXRange
        set TheYRange=GetItemY(TheTarget)-GetUnitY(TheUnit)
        set TheYRange=TheYRange*TheYRange
        return(SquareRoot(TheXRange+TheYRange))
    endif
    return 0.
endfunction

function GetAngleDelta takes real Angle1,real Angle2 returns real
    if Angle1<Angle2 then
        return(Angle2-Angle1)
    else
        return(Angle1-Angle2)
    endif
endfunction
function GetAngle takes location LocA,location LocB returns real
    local real TheAngle=AngleBetweenPoints(LocA,LocB)
    if TheAngle<0 then
        set TheAngle=TheAngle+360
    endif
    return TheAngle
endfunction

function GetUnitToOuterLocAngle takes unit TheUnit,unit TheTarget,real TheRange,real angle returns location
    local location TargetLoc
    local location UnitLoc
    local real TheDir
    if(TheUnit!=null)and(TheTarget!=null)and(IsAlive(TheUnit))and(IsAlive(TheTarget))then
        set TargetLoc=GetUnitLoc(TheTarget)
        set UnitLoc=GetUnitLoc(TheUnit)
        set TheDir=Deg2Rad(GetAngle(TargetLoc,UnitLoc)+angle)
        call RemoveLocation(UnitLoc)
        call RemoveLocation(TargetLoc)
        return(Location(TheRange*Cos(TheDir)+GetUnitX(TheTarget),TheRange*Sin(TheDir)+GetUnitY(TheTarget)))
    endif
    return null
endfunction
function GetLocToOuterLocAngle takes location loc1,location loc2,real TheRange,real angle returns location
    local real TheDir
    if loc1==null or loc2==null then
        return null
    endif
    set TheDir=Deg2Rad(GetAngle(loc2,loc1)+angle)
    
    return(Location(TheRange*Cos(TheDir)+GetLocationX(loc2),TheRange*Sin(TheDir)+GetLocationY(loc2)))
endfunction
function GetUnitBackLoc takes unit TheTarget,real TheRange returns location
    local real TheDir
    if(TheTarget!=null)and(IsAlive(TheTarget))then
        set TheDir=Deg2Rad(GetUnitFacing(TheTarget)+180)
        return(Location(TheRange*Cos(TheDir)+GetUnitX(TheTarget),TheRange*Sin(TheDir)+GetUnitY(TheTarget)))
    endif
    return null
endfunction
function GetUnitFrontLoc takes unit TheTarget,real TheRange returns location
    local real TheDir
    if(TheTarget!=null)and(IsAlive(TheTarget))then
        set TheDir=Deg2Rad(GetUnitFacing(TheTarget))
        return(Location(TheRange*Cos(TheDir)+GetUnitX(TheTarget),TheRange*Sin(TheDir)+GetUnitY(TheTarget)))
    endif
    return null
endfunction


function GetLocBetweenTwoLocsRangeToFirst takes location TheLoc1,location TheLoc2,real TheRange returns location
    local real TheDir
    local real rdm=0
    set TheDir=Deg2Rad(GetAngle(TheLoc2,TheLoc1)+180)
    return(Location(TheRange*Cos(TheDir)+GetLocationX(TheLoc1),TheRange*Sin(TheDir)+GetLocationY(TheLoc1)))
    return null
endfunction

function GetLocBetweenTwoUnitsRangeToFirst takes unit u1,unit u2,real TheRange returns location
    local real TheDir
    local real rdm=0
    local location TheLoc1=GetUnitLoc(u1)
    local location TheLoc2=GetUnitLoc(u2)
    local location loc3=null
    set TheDir=Deg2Rad(GetAngle(TheLoc2,TheLoc1)+180)
    set loc3=(Location(TheRange*Cos(TheDir)+GetLocationX(TheLoc1),TheRange*Sin(TheDir)+GetLocationY(TheLoc1)))
    call RemoveLocation(TheLoc1)
    set TheLoc1=null
    call RemoveLocation(TheLoc2)
    set TheLoc2=null
    
    return loc3
endfunction




function GetItemLoc takes item whichItem returns location
    return Location(GetItemX(whichItem), GetItemY(whichItem))
endfunction
function GetSparedItemByID takes unit TheUnit,integer TheItemID returns item
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    local integer nItems=0
    if(MaxSlot>0)then
        set TheSlot=0
        set nItems=0
        loop
            exitwhen(TheSlot>=MaxSlot)
            if(GetItemTypeId(UnitItemInSlot(TheUnit,TheSlot))==TheItemID)then
                set nItems=nItems+1
            endif
            exitwhen(nItems>1)
            set TheSlot=TheSlot+1
        endloop
        if(nItems>1)then
            return(UnitItemInSlot(TheUnit,TheSlot))
        endif
    endif
    return(null)
endfunction
function GetSparedItemByName takes unit TheUnit,string ItemName returns item
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    local integer nItems=0
    if(MaxSlot>0)then
        set TheSlot=0
        set nItems=0
        loop
            exitwhen(TheSlot>=MaxSlot)
            if(GetItemName(UnitItemInSlot(TheUnit,TheSlot))==ItemName)then
                set nItems=nItems+1
            endif
            exitwhen(nItems>1)
            set TheSlot=TheSlot+1
        endloop
        if(nItems>1)then
            return(UnitItemInSlot(TheUnit,TheSlot))
        endif
    endif
    return(null)
endfunction
function GetItemSlotByID takes unit TheUnit,integer TheItemID returns integer
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    if(MaxSlot>0)then
        set TheSlot=0
        loop
            exitwhen(TheSlot>=MaxSlot)or(GetItemTypeId(UnitItemInSlot(TheUnit,TheSlot))==TheItemID)
            set TheSlot=TheSlot+1
        endloop
        if(TheSlot<MaxSlot)then
            return(TheSlot)
        endif
    endif
    return(-1)
endfunction
function GetItemSlotByName takes unit TheUnit,string ItemName returns integer
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    if(MaxSlot>0)then
        set TheSlot=0
        loop
            exitwhen(TheSlot>=MaxSlot)or(GetItemName(UnitItemInSlot(TheUnit,TheSlot))==ItemName)
            set TheSlot=TheSlot+1
        endloop
        if(TheSlot<MaxSlot)then
            return(TheSlot)
        endif
    endif
    return(-1)
endfunction
function GetItemByID takes unit TheUnit,integer TheItemID returns item
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    if(MaxSlot>0)then
        set TheSlot=0
        loop
            exitwhen(TheSlot>=MaxSlot)or(GetItemTypeId(UnitItemInSlot(TheUnit,TheSlot))==TheItemID)
            set TheSlot=TheSlot+1
        endloop
        if(TheSlot<MaxSlot)then
            return(UnitItemInSlot(TheUnit,TheSlot))
        endif
    endif
    return(null)
endfunction


function GetItemChargesById takes  unit TheUnit,integer itemid returns integer
    return GetItemCharges(GetItemByID(TheUnit,itemid))
    //return
endfunction
function GetItemByName takes unit TheUnit,string ItemName returns item
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    if(MaxSlot>0)then
        set TheSlot=0
        loop
            exitwhen(TheSlot>=MaxSlot)or(GetItemName(UnitItemInSlot(TheUnit,TheSlot))==ItemName)
            set TheSlot=TheSlot+1
        endloop
        if(TheSlot<MaxSlot)then
            return(UnitItemInSlot(TheUnit,TheSlot))
        endif
    endif
    return(null)
endfunction
function GetNumberOfItemByID takes unit TheUnit,integer TheItemID returns integer
    local integer MaxSlot=UnitInventorySize(TheUnit)
    local integer TheSlot=0
    local integer TheResult=0
    if(MaxSlot>0)then
        set TheSlot=0
        loop
            exitwhen(TheSlot>=MaxSlot)
            if(GetItemTypeId(UnitItemInSlot(TheUnit,TheSlot))==TheItemID)then
                set TheResult=TheResult+1
            endif
            set TheSlot=TheSlot+1
        endloop
    endif
    return TheResult
endfunction
function DropItemByID takes unit TheUnit,integer ItemID,location TheLoc returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    local boolean TheOK
    if TheItem!=null then
        set TheOK=UnitDropItemPoint(TheUnit,TheItem,GetLocationX(TheLoc),GetLocationY(TheLoc))
        if TheOK then
            call SetItemPlayer(TheItem,GetOwningPlayer(TheUnit),false)
            call SetItemDropID(TheItem,GetUnitTypeId(TheUnit))
        endif
        return(TheOK)
    endif
    return false
endfunction

function gotoLocation takes unit u, location loc,real stopRange returns boolean
    if (RangeToLoc(u,loc) <=stopRange) then
        //    call debugstr("dao da")
        //     call debugstr(R2S(DistanceBetweenPoints(loc,GetUnitLoc(mHero))))
        
        call IssueImmediateOrder( u, "stop")
        return true
    else
        call IssuePointOrderLoc( u, "move", loc )
        return  false
    endif
endfunction
function gotoLocation2 takes unit u, unit u2,real stopRange returns boolean
    local location loc=GetUnitLoc(u2)
    local boolean rb=false
    set rb= gotoLocation(u,loc,stopRange)
    call RemoveLocation(loc)
    set loc=null
    return rb
endfunction
function ariveLoc takes unit u, location loc,real bias returns nothing
    
    loop
        exitwhen  gotoLocation(u,loc,bias)
        call Sleep(0.5)
    endloop
    //return
endfunction
function ariveUnit takes unit u, unit u2,real bias returns nothing
    
    loop
        exitwhen  gotoLocation2(u,u2,bias)
        call Sleep(0.5)
    endloop
    //return
endfunction


function PickItem takes  unit TheUnit,item Target returns boolean
    local boolean TheOK
    if Target==null then
        return false
    endif
    call ariveLoc(TheUnit,GetItemLoc(Target),50)
    set TheOK= IssueTargetOrder(TheUnit,"smart",Target)
    call Sleep(0.6)
    return TheOK
endfunction


function DropItemByName takes unit TheUnit,string ItemName,location TheLoc returns boolean
    local item TheItem=GetItemByName(TheUnit,ItemName)
    local boolean TheOK
    if TheItem!=null then
        set TheOK=UnitDropItemPoint(TheUnit,TheItem,GetLocationX(TheLoc),GetLocationY(TheLoc))
        if TheOK then
            call SetItemPlayer(TheItem,GetOwningPlayer(TheUnit),false)
            call SetItemDropID(TheItem,GetUnitTypeId(TheUnit))
        endif
        return(TheOK)
    endif
    return false
endfunction
function GiveItemByID takes unit TheUnit,integer ItemID,unit TheTarget returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    if TheItem!=null then
        return(UnitDropItemTarget(TheUnit,TheItem,TheTarget))
    endif
    return false
endfunction
function GiveItemByName takes unit TheUnit,string ItemName,unit TheTarget returns boolean
    local item TheItem=GetItemByName(TheUnit,ItemName)
    if TheItem!=null then
        return(UnitDropItemTarget(TheUnit,TheItem,TheTarget))
    endif
    return false
endfunction
function RemoveItemByID takes unit TheUnit,integer ItemID returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    if TheItem!=null then
        return(RemoveItem(TheItem))
    endif
    return false
endfunction
function RemoveItemByName takes unit TheUnit,string ItemName returns boolean
    local item TheItem=GetItemByName(TheUnit,ItemName)
    if TheItem!=null then
        return(RemoveItem(TheItem))
    endif
    return false
endfunction

function SellItemToStore takes unit TheUnit,item TheItem,unit TheStore  returns boolean
    if(TheItem!=null)and(TheStore!=null)then
        if UnitDropItemTarget(TheUnit,TheItem,TheStore)then
            call Sleep(0.5)
            return true
        endif
    endif
    return false
endfunction


function setItemCanUse takes unit u, boolean flag returns nothing
    if flag then
        call SetUnitUserData(u,0)
    else
        call SetUnitUserData(u,11)
    endif
endfunction

function UseItemByID takes unit TheUnit,integer ItemID returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    local boolean rb=false
    call setItemCanUse(TheUnit,true)
    set rb=(TheItem!=null)and(UnitUseItem(TheUnit,TheItem))
    call setItemCanUse(TheUnit,false)
    return rb
endfunction
function UnitUseItemPointLoc takes unit whichUnit, item whichItem, location loc returns boolean
    local boolean rb=false
    call setItemCanUse(whichUnit,true)
    set rb= UnitUseItemPoint(whichUnit, whichItem, GetLocationX(loc), GetLocationY(loc))
    call setItemCanUse(whichUnit,false)
    return rb
endfunction

function UseItemPointByID takes unit TheUnit,integer ItemID,location TheLoc returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    return(TheItem!=null)and(UnitUseItemPointLoc(TheUnit,TheItem,TheLoc))
endfunction
function UseItemTargetByID takes unit TheUnit,integer ItemID,widget TheTarget returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    
    local boolean rb=false
    
    if TheItem==null or TheTarget==null or  TheUnit==null then
        call debugstr("item----null")
    endif
    call setItemCanUse(TheUnit,true)
    
    set rb=(TheItem!=null)and(UnitUseItemTarget(TheUnit,TheItem,TheTarget))
    //call Sleep(0.1)
    call setItemCanUse(TheUnit,false)
    if rb then
        call debugstr("used")
        
    endif
    return rb
endfunction

function can_UseItemByID takes unit TheUnit,integer ItemID  returns boolean
    local item TheItem=GetItemByID(TheUnit,ItemID)
    local boolean rb=false
    if TheItem==null or  TheUnit==null then
        //call debugstr("item----null")
    endif
    call setItemCanUse(TheUnit,true)
    
    set rb=(TheItem!=null)and(UnitUseItem(TheUnit,TheItem))
    //call Sleep(0.1)
    call setItemCanUse(TheUnit,false)
    if rb then
        call HeroStop(TheUnit)
        //     call debugstr("used")
    endif
    return rb
endfunction


function GetHP takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_LIFE))
endfunction
function GetMaxHP takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_MAX_LIFE))
endfunction
function GetHPVoided takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_MAX_LIFE)-GetUnitState(TheUnit,UNIT_STATE_LIFE))
endfunction
function GetAcquRange takes unit TheUnit returns real
    return(GetUnitAcquireRange(TheUnit))
endfunction


function IsEntangled takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'BEer')>0 )
endfunction
function IsJuFeng takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'Bcy2')>0  or GetUnitAbilityLevel(TheUnit,'Bcyc')>0)
endfunction

function IsBianXing takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'BOhx')>0)
endfunction
function IsRangeAttacker takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_RANGED_ATTACKER))
endfunction
function IsGroundAttacker takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_ATTACKS_GROUND))
endfunction

function IsStunned takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_STUNNED))or(GetUnitAbilityLevel(TheUnit,'BUim')>0) or GetUnitAbilityLevel(TheUnit,'BPSE')>0 or IsUnitPaused(TheUnit) or GetUnitAbilityLevel(TheUnit,'B012')>0
endfunction
function IsLocked takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_STUNNED))or(IsUnitType(TheUnit,UNIT_TYPE_SNARED))
endfunction
function IsPoisoned takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_POISONED))or(GetUnitAbilityLevel(TheUnit,'B027')>0)or(GetUnitAbilityLevel(TheUnit,'B028')>0)
endfunction
function IsSlowed takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_POISONED))or(IsUnitType(TheUnit,UNIT_TYPE_POLYMORPHED))or(IsUnitType(TheUnit,UNIT_TYPE_ETHEREAL))or(IsUnitType(TheUnit,UNIT_TYPE_PLAGUED))
endfunction
function IsSlowStriked takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'BEsh')>0)or(GetUnitAbilityLevel(TheUnit,'BEsi')>0)or(GetUnitAbilityLevel(TheUnit,'B001')>0)
endfunction
function IsRestoreHP takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'BIrl')>0)
endfunction
function IsRestoreMP takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'BIrm')>0)
endfunction
function GetMP takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_MANA))
endfunction
function GetMaxMana takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_MAX_MANA))
endfunction
function GetManaVoided takes unit TheUnit returns real
    return(GetUnitState(TheUnit,UNIT_STATE_MAX_MANA)-GetUnitState(TheUnit,UNIT_STATE_MANA))
endfunction
function GetUnitStatePercent takes unit whichUnit, unitstate whichState, unitstate whichMaxState returns real
    local real value    = GetUnitState(whichUnit, whichState)
    local real maxValue = GetUnitState(whichUnit, whichMaxState)
    if (whichUnit == null) or (maxValue == 0) then
        return 0.0
    endif
    return value / maxValue * 100.0
endfunction
function GetUnitManaPercent takes unit whichUnit returns real
    return GetUnitStatePercent(whichUnit, UNIT_STATE_MANA, UNIT_STATE_MAX_MANA)
endfunction
function IsManaAlmostFull takes unit TheUnit returns boolean
    return((GetMP(TheUnit)>=1200)or(GetUnitManaPercent(TheUnit)>85))
endfunction
function GetUnitLifePercent takes unit whichUnit returns real
    return GetUnitStatePercent(whichUnit, UNIT_STATE_LIFE, UNIT_STATE_MAX_LIFE)
endfunction
function IsLifeAlmostFull takes unit TheUnit returns boolean
    return(GetUnitLifePercent(TheUnit)>85)
endfunction
function IsAlmostFullyRecovered takes unit TheUnit returns boolean
    return(GetUnitLifePercent(TheUnit)>85)and((GetMaxMana(TheUnit)==0)or(GetUnitManaPercent(TheUnit)>85))
endfunction
function IsAlmostDead takes unit TheUnit returns boolean
    return((GetUnitLifePercent(TheUnit)<=10)or(GetHP(TheUnit)<50))
endfunction
function IsLowLife takes unit TheUnit returns boolean
    local real MinHP=200
    if IsDead(TheUnit) then
        return false
    endif
    return((GetUnitLifePercent(TheUnit)<20)or(GetUnitState(TheUnit,UNIT_STATE_LIFE)<MinHP))
endfunction
function IsDying takes unit TheUnit returns boolean
    return((GetUnitLifePercent(TheUnit)<10))
endfunction
function IsNearDeath takes unit TheUnit returns boolean
    local real MinHP=100
    return(GetUnitState(TheUnit,UNIT_STATE_LIFE)<MinHP)
endfunction
function IsAboveDeath takes unit TheUnit returns boolean
    return(GetUnitLifePercent(TheUnit)>30)and(GetUnitState(TheUnit,UNIT_STATE_LIFE)>400)
endfunction
function IsHalfDead takes unit TheUnit returns boolean
    return((GetUnitLifePercent(TheUnit)<50))
endfunction
function IsLowMana takes unit TheUnit returns boolean
    return(((GetMaxMana(TheUnit)>0)and(GetUnitManaPercent(TheUnit)<35))or(GetUnitState(TheUnit,UNIT_STATE_MANA)<150+GetUnitLevel(TheUnit)*13))
endfunction
function IsStillOK takes unit TheUnit returns boolean
    return((GetUnitLifePercent(TheUnit)>60)and((GetMaxMana(TheUnit)==0)or(GetUnitManaPercent(TheUnit)>40)))
endfunction
function IsImmune takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_MAGIC_IMMUNE))
endfunction
function CanAttack takes unit TheUnit returns boolean
    return((GetUnitAbilityLevel(TheUnit,'Aatk')>0)or(IsUnitType(TheUnit,UNIT_TYPE_RANGED_ATTACKER))or(IsUnitType(TheUnit,UNIT_TYPE_MELEE_ATTACKER))or(IsUnitType(TheUnit,UNIT_TYPE_ATTACKS_GROUND))or(IsUnitType(TheUnit,UNIT_TYPE_ATTACKS_FLYING)))
endfunction
function CanNotAttack takes unit TheUnit returns boolean
    return(not(CanAttack(TheUnit)))
endfunction
function CanMove takes unit TheUnit returns boolean
    return(GetUnitAbilityLevel(TheUnit,'Amov')>0)
endfunction
function CanNotMove takes unit TheUnit returns boolean
    return(not(CanMove(TheUnit)))
endfunction
function IsSummoned takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_SUMMONED))
endfunction
function IsAncient takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_ANCIENT))
endfunction
function IsNotAncient takes unit TheUnit returns boolean
    return(not IsUnitType(TheUnit,UNIT_TYPE_ANCIENT))
endfunction
function IsStructure takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_STRUCTURE))
endfunction
function IsTower takes unit TheUnit returns boolean
    return((IsUnitType(TheUnit,UNIT_TYPE_STRUCTURE))and(CanAttack(TheUnit)))
endfunction
function IsNotStructure takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_STRUCTURE)==false)
endfunction
function IsAlsoHero takes unit TheUnit returns boolean
    return(IsUnitType(TheUnit,UNIT_TYPE_HERO))
endfunction
function IsUnitHero takes unit TheUnit returns boolean
    return((IsUnitType(TheUnit,UNIT_TYPE_HERO))and(IsUnitIllusion(TheUnit)==false))
endfunction
function IsNotHero takes unit TheUnit returns boolean
    return(IsUnitHero(TheUnit)==false)
endfunction
function IsFountain takes unit TheUnit returns boolean
    local string UnitName=GetUnitName(TheUnit)
    return(UnitName=="")or(UnitName=="")
endfunction
function IsEnemyBing takes unit TheUnit returns boolean
    return((IsUnitEnemy(TheUnit,ai_player))and(not IsUnitHero(TheUnit))and(not IsStructure(TheUnit))and(CanAttack(TheUnit))and(UnitAlive(TheUnit))  and(CanMove(TheUnit)))
endfunction

function IsEnemyTower takes unit TheUnit returns boolean
    return(IsUnitEnemy(TheUnit,ai_player)and(UnitAlive(TheUnit))and IsTower(TheUnit))
endfunction
function IsAllyTower takes unit TheUnit returns boolean
    return(IsUnitAlly(TheUnit,ai_player)and(UnitAlive(TheUnit))and IsTower(TheUnit))
endfunction



function isZhongLiEnemy takes unit u returns boolean
    if IsUnitOwnedByPlayer(u,Player(12)) then
        return true
    endif
    return false
endfunction
function IsEnemyAttaker takes unit TheUnit returns boolean
    
    return(IsUnitEnemy(TheUnit,ai_player)and(UnitAlive(TheUnit)))
endfunction

function IsAllyBing takes unit TheUnit returns boolean
    return((IsUnitAlly(TheUnit,ai_player))and(not IsUnitHero(TheUnit))and(not IsStructure(TheUnit))and(CanAttack(TheUnit))and(UnitAlive(TheUnit)) and(CanMove(TheUnit)))
endfunction
function GetPlayerGold takes player p returns integer
    return GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
endfunction
function TakePlayerGold takes player ThePlayer,integer GoldToTake returns nothing
    call SetPlayerState(ThePlayer,PLAYER_STATE_RESOURCE_GOLD,GetPlayerGold(ThePlayer)-GoldToTake)
endfunction
function GivePlayerGold takes player ThePlayer,integer GoldToGive returns nothing
    call SetPlayerState(ThePlayer,PLAYER_STATE_RESOURCE_GOLD,GetPlayerGold(ThePlayer)+GoldToGive)
endfunction

function GetPlayerWood takes player p returns integer
    return GetPlayerState(p,PLAYER_STATE_RESOURCE_LUMBER)
endfunction
function IsMoving2 takes unit TheUnit returns boolean
    local string TheOrder=OrderId2String(GetUnitCurrentOrder(TheUnit))
    return(TheOrder=="move")or(TheOrder=="AImove")or(TheOrder=="blink")
endfunction
function IsMoving takes unit TheUnit returns boolean
    local integer TheOrder=GetUnitCurrentOrder(TheUnit)
    return(TheOrder==OrderId("move"))or(TheOrder==OrderId("AImove"))or(TheOrder==OrderId("blink"))or(TheOrder==OrderId("patrol"))or(TheOrder==OrderId("attack"))or(TheOrder==OrderId("smart"))
endfunction


function IsNotMoving takes unit TheUnit returns boolean
    return(IsMoving(TheUnit)==false)
endfunction

function HasSkill takes unit TheUnit,integer abilcode returns boolean
    local boolean rb=false
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set rb=GetUnitAbilityLevel(TheUnit,abilcode)>0
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return rb
endfunction
function HasBuff takes unit TheUnit,integer buffid returns boolean
    return GetUnitAbilityLevel(TheUnit,buffid)>0
endfunction
function isZhaoYunHasB takes unit theunit returns boolean
    return HasBuff(theunit,'B00F')
endfunction
function isHeroHasSunzi takes unit theunit returns boolean
    return HasBuff(theunit,'Bspe')
endfunction
function isGuanyuXuanFeng takes unit theunit returns boolean
    return HasBuff(theunit,'BOww')
endfunction
function isHeroHasJinglinghuo takes unit theunit returns boolean
    return HasBuff(theunit,'Bfae')
endfunction
function iszhangfeihasb takes unit theunit returns boolean
    return HasBuff(theunit,'Bbsk')
endfunction


function GetUnitAbilityLevelZs takes unit TheUnit,integer abilcode returns integer
    local integer ri=0
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set ri=GetUnitAbilityLevel(TheUnit,abilcode)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return ri
endfunction
function RaiseSkill takes unit TheUnit,integer abilcode returns boolean
    local integer LastPoint=GetHeroSkillPoints(TheUnit)
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    call SelectHeroSkill(TheUnit,abilcode)
    
    //sima
    if abilcode!='A03P' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    endif
    
    //zhangliao
    if abilcode=='A00O' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    if abilcode=='A00U' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    
    //zhaoyun
    if abilcode=='A019' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    if abilcode=='A01B' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    //guanyu
    if abilcode=='A00C' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    //dianwei
    if abilcode=='A06D' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    if abilcode=='A03R' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    //zhangfei
    if abilcode=='Amgr' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    //weiyan
    if abilcode=='A00D' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    if abilcode=='A01B' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    //guoji
    if abilcode=='A022' then
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    endif
    
    
    return(GetHeroSkillPoints(TheUnit)<LastPoint)
endfunction

function CanCastAbilityOrder takes unit TheUnit,integer abilcode,string order returns boolean
    local  boolean canCast=false
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    //set canCast=IssuePointOrderLoc(TheUnit,order,Loc)
    set canCast=IssueImmediateOrder(TheUnit,order)
    if  canCast  then
        call IssueImmediateOrder( TheUnit, "stop" )
        
        //call debugstr("can cast "+order)
        // else
        // call debugstr("can--------- not ---------------cast "+order)
    endif
    
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return  canCast
endfunction

function CanCastAbilityOrderPause takes unit TheUnit,integer abilcode,string order returns boolean
    local  boolean canCast=false
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    //set canCast=IssuePointOrderLoc(TheUnit,order,Loc)
    set canCast=IssueImmediateOrder(TheUnit,order)
    if  canCast  then
        call PauseUnit( TheUnit, true )
        call IssueImmediateOrder( TheUnit, "stop" )
        call PauseUnit( TheUnit, false )
        
        //call debugstr("can cast "+order)
        // else
        // call debugstr("can--------- not ---------------cast "+order)
    endif
    
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return  canCast
endfunction

function CanCastAbilityOrderById takes unit TheUnit,integer abilcode,integer order returns boolean
    local  boolean canCast=false
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    //set canCast=IssuePointOrderLoc(TheUnit,order,Loc)
    set canCast=IssueImmediateOrderById(TheUnit,order)
    if  canCast  then
        //call debugstr("can cast "+order)
        
        call IssueImmediateOrder( TheUnit, "stop" )
        
    else
        // call debugstr("can--------- not ---------------cast "+order)
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return  canCast
endfunction
function CanCastAbilityOrderByStr takes unit TheUnit,integer abilcode,string order returns boolean
    local  boolean canCast=false
    local player ThePlayer=GetOwningPlayer(TheUnit)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    //set canCast=IssuePointOrderLoc(TheUnit,order,Loc)
    set canCast=IssueImmediateOrder(TheUnit,order)
    if  canCast  then
        //call debugstr("can cast "+order)
        
        call IssueImmediateOrder( TheUnit, "stop" )
        
    else
        // call debugstr("can--------- not ---------------cast "+order)
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return  canCast
endfunction



function CastImmediateSkillByID takes unit TheUnit,integer abilcode returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set Casted=IssueImmediateOrderById(TheUnit,abilcode)
    if Casted then
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastPointSkillByOderStr takes unit TheUnit,integer abilcode,string order ,location TheLoc returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    
    set Casted=IssuePointOrderLoc(TheUnit,order,TheLoc)
    if Casted then
        
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastTargetSkillByOderStrDelayed takes unit TheUnit,integer abilcode,string order ,location TheLoc,real delay returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set Casted=IssuePointOrderLoc(TheUnit,order,TheLoc)
    call Sleep(delay)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastTargetSkillByOderIdDelayed takes unit TheUnit,integer abilcode,integer Order ,unit TheTaget,real delay returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local location Loc=null
    
    local boolean Casted
    set Loc=GetUnitLoc(TheTaget)
    
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    
    set Casted=IssuePointOrderByIdLoc(TheUnit,Order,Loc)
    call Sleep(delay-0.25)
    if not IsUnitInRangeLoc(TheTaget,Loc,300) then
        call IssueImmediateOrder(TheUnit,"stop")
        call debugstr("stop dazhao sima==========================")
        call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
        call RemoveLocation(Loc)
        set Loc=null
        return false
    endif
    call Sleep(0.55)
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    call RemoveLocation(Loc)
    set Loc=null
    
    return(Casted)
endfunction
function CastTargetSkillByOderStr takes unit TheUnit,integer abilcode,string order ,unit TheTarget returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    
    set Casted=IssueTargetOrder(TheUnit,order,TheTarget)
    if Casted then
        
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction
function CastTargetSkillByOderId takes unit TheUnit,integer abilcode,integer order ,unit TheTarget returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    
    set Casted=IssueTargetOrderById(TheUnit,order,TheTarget)
    if Casted then
        
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastTargetSkillByID takes unit TheUnit,integer abilcode,widget TheTarget returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set Casted=IssueTargetOrderById(TheUnit,abilcode,TheTarget)
    if Casted then
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastImdSkillByID takes unit TheUnit,integer abilcode ,integer order returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set Casted=IssueImmediateOrderById(TheUnit,order)
    if Casted then
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function CastImdSkillByStr takes unit TheUnit,integer abilcode ,string order returns boolean
    local player ThePlayer=GetOwningPlayer(TheUnit)
    local integer PlayerID=GetPlayerId(ThePlayer)
    local boolean Casted
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,true)
    set Casted=IssueImmediateOrder(TheUnit,order)
    if Casted then
    endif
    call SetPlayerAbilityAvailable(ThePlayer,abilcode,false)
    return(Casted)
endfunction

function debugUnit takes unit u,integer id returns nothing
    local location Loc= GetUnitLoc(u)
    call debugLoc(Loc,id)
    call RemoveLocation(Loc)
    set Loc=null
    
    //call SetUnitColor( u,ConvertPlayerColor(11))
    
    //return
endfunction

function BuyItem_im takes unit FromShop,integer TheItemID,unit ToUnit returns boolean
    //if(IssueNeutralTargetOrder(GetOwningPlayer(ToUnit),FromShop,"smart",ToUnit))or(IssueTargetOrder(FromShop,"smart",ToUnit))then
    return(IssueNeutralImmediateOrderById(GetOwningPlayer(ToUnit),FromShop,TheItemID))or(IssueImmediateOrderById(FromShop,TheItemID))
    //endif
    //return(false)
endfunction


function isZhuGeLiang takes nothing returns boolean
    return  mHeroId==hid_zhugeliang
endfunction
function isSiMaYi takes nothing returns boolean
    return  mHeroId==hid_simayi
endfunction
function iszhaoyun takes nothing returns boolean
    return  mHeroId==hid_zhaoyun
endfunction
function iszhangliao takes nothing returns boolean
    return  mHeroId==hid_zhangliao
endfunction
function isguanyu takes nothing returns boolean
    return  mHeroId==hid_guanyu
endfunction
function iszhangfei takes nothing returns boolean
    return  mHeroId==hid_zhangfei
endfunction
function isweiyan takes nothing returns boolean
    return  mHeroId==hid_weiyan
endfunction
function isguojia takes nothing returns boolean
    return  mHeroId==hid_guojia
endfunction
function iscaoren takes nothing returns boolean
    return  mHeroId==hid_caoren
endfunction
function isdianwei takes nothing returns boolean
    return  mHeroId==hid_dianwei
endfunction
function isxun takes nothing returns boolean
    return  mHeroId==hid_xun
endfunction


function initSkillArry_zhugeliang takes nothing returns nothing
    set mSkillArray[0]='A08I'  //+
    set mSkillArray[1]='A087'  //G
    set mSkillArray[2]='A087'  //G
    set mSkillArray[3]='A08I'  //+
    set mSkillArray[4]='A087'  //G
    set mSkillArray[5]='A083'  //X
    set mSkillArray[6]='A087'  //G
    set mSkillArray[7]='A085'  //E
    set mSkillArray[8]='A08I'  //+
    set mSkillArray[9]='A08I'  //+
    set mSkillArray[10]='A083'  //X
    set mSkillArray[11]='A08I'  //+
    set mSkillArray[12]='A08I'  //+
    set mSkillArray[13]='A08I'  //+
    set mSkillArray[14]='A085'  //E
    set mSkillArray[15]='A083'  //X
    set mSkillArray[16]='A085'  //E
    set mSkillArray[17]='A085'  //E
    set mSkillArray[18]='A08I'  //+
    set mSkillArray[19]='A08I'  //+
    set mSkillArray[20]='A08I'  //+
    set mSkillArray[21]='A08A'  //W
    set mSkillArray[22]='A08A'  //W
    set mSkillArray[23]='A08A'  //W
    set mSkillArray[24]='A08A'  //W
    //return
endfunction
function initSkillArry_simayi takes nothing returns nothing
    set mSkillArray[0]='A07A'  //E
    set mSkillArray[1]='A03O'  //F
    set mSkillArray[2]='A07A'  //E
    set mSkillArray[3]='A03O'  //F
    set mSkillArray[4]='A07A'  //E
    set mSkillArray[5]='A03O'  //F
    set mSkillArray[6]='A03O'  //F
    set mSkillArray[7]='A07A'  //E
    set mSkillArray[8]='Aamk'  //+
    set mSkillArray[9]='A041'  //N
    set mSkillArray[10]='A041'   //11
    set mSkillArray[11]='Aamk'
    set mSkillArray[12]='Aamk'
    set mSkillArray[13]='Aamk'
    set mSkillArray[14]='Aamk'
    set mSkillArray[15]='A041'  //16
    set mSkillArray[16]='A03P'
    set mSkillArray[17]='A03P'
    set mSkillArray[18]='A03P'
    set mSkillArray[19]='A03P'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction

function initSkillArry_zhaoyun takes nothing returns nothing
    set mSkillArray[0]='A06K'  //c
    set mSkillArray[1]='A019'  //s
    set mSkillArray[2]='Aamk'  //+
    set mSkillArray[3]='A019'  //
    set mSkillArray[4]='Aamk'
    set mSkillArray[5]='A01V'     //6
    set mSkillArray[6]='A019'
    set mSkillArray[7]='Aamk'
    set mSkillArray[8]='A019'
    set mSkillArray[9]='Aamk'
    set mSkillArray[10]='A01V'   //11
    set mSkillArray[11]='A06K'
    set mSkillArray[12]='A06K'
    set mSkillArray[13]='A06K'
    set mSkillArray[14]='A01B'
    set mSkillArray[15]='A01V'  //16
    set mSkillArray[16]='A01B'
    set mSkillArray[17]='A01B'
    set mSkillArray[18]='A01B'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction

function initSkillArry_zhangliao takes nothing returns nothing
    set mSkillArray[0]='AOsh'  //w
    set mSkillArray[1]='AHtb'  //f
    set mSkillArray[2]='AOsh'  //
    set mSkillArray[3]='AHtb'  //
    set mSkillArray[4]='AOsh'
    set mSkillArray[5]='A00O'     //6
    set mSkillArray[6]='AOsh'
    set mSkillArray[7]='AHtb'
    set mSkillArray[8]='AHtb'
    set mSkillArray[9]='Aamk'
    set mSkillArray[10]='A00O'   //11
    set mSkillArray[11]='A00U'
    set mSkillArray[12]='A00U'
    set mSkillArray[13]='A00U'
    set mSkillArray[14]='A00U'
    set mSkillArray[15]='A00O'  //16
    set mSkillArray[16]='Aamk'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction

function initSkillArry_guanyu takes nothing returns nothing
    set mSkillArray[0]='A011'  //x
    set mSkillArray[1]='A00R'  //d
    set mSkillArray[2]='A011'  //
    set mSkillArray[3]='A00R'  //
    set mSkillArray[4]='A011'
    set mSkillArray[5]='A00A'     //6
    set mSkillArray[6]='A011'
    set mSkillArray[7]='A00R'
    set mSkillArray[8]='A00R'
    set mSkillArray[9]='A00C'
    set mSkillArray[10]='A00A'   //11
    set mSkillArray[11]='A00C'
    set mSkillArray[12]='A00C'
    set mSkillArray[13]='A00C'
    set mSkillArray[14]='Aamk'
    set mSkillArray[15]='A00A'  //16
    set mSkillArray[16]='Aamk'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_zhangfei takes nothing returns nothing
    set mSkillArray[0]='A04W'  //t
    set mSkillArray[1]='Aamk'  //d
    set mSkillArray[2]='A04W'  //
    set mSkillArray[3]='Aamk'  //
    set mSkillArray[4]='A04W'
    set mSkillArray[5]='A006'     //6
    set mSkillArray[6]='A04W'
    set mSkillArray[7]='Amgr'
    set mSkillArray[8]='A009'
    set mSkillArray[9]='A009'
    set mSkillArray[10]='A006'   //11
    set mSkillArray[11]='A009'
    set mSkillArray[12]='A009'
    set mSkillArray[13]='Amgr'
    set mSkillArray[14]='Amgr'
    set mSkillArray[15]='A006'  //16
    set mSkillArray[16]='Amgr'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_weiyan takes nothing returns nothing
    set mSkillArray[0]='A02A'  //t
    set mSkillArray[1]='Aamk'  //d
    set mSkillArray[2]='A02A'  //
    set mSkillArray[3]='Aamk'  //
    set mSkillArray[4]='A02A'
    set mSkillArray[5]='A00H'     //6
    set mSkillArray[6]='A02A'
    set mSkillArray[7]='A00D'
    set mSkillArray[8]='A00D'
    set mSkillArray[9]='A00D'
    set mSkillArray[10]='A00H'   //11
    set mSkillArray[11]='A00D'
    set mSkillArray[12]='A01B'
    set mSkillArray[13]='A01B'
    set mSkillArray[14]='A01B'
    set mSkillArray[15]='A00H'  //16
    set mSkillArray[16]='A01B'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_guojia takes nothing returns nothing
    set mSkillArray[0]='A00W'  //t
    set mSkillArray[1]='A022'  //d
    set mSkillArray[2]='A00W'  //
    set mSkillArray[3]='A022'  //
    set mSkillArray[4]='A00W'
    set mSkillArray[5]='A01F'     //6
    set mSkillArray[6]='A00W'
    set mSkillArray[7]='A022'
    set mSkillArray[8]='A022'
    set mSkillArray[9]='AUfu'
    set mSkillArray[10]='A01F'   //11
    set mSkillArray[11]='AUfu'
    set mSkillArray[12]='AUfu'
    set mSkillArray[13]='AUfu'
    set mSkillArray[14]='Aamk'
    set mSkillArray[15]='A01F'  //16
    set mSkillArray[16]='Aamk'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_caoren takes nothing returns nothing
    set mSkillArray[0]='AUcs'  //t
    set mSkillArray[1]='AUsl'  //d
    set mSkillArray[2]='AUcs'  //
    set mSkillArray[3]='Aamk'  //
    set mSkillArray[4]='AUcs'
    set mSkillArray[5]='A030'     //6
    set mSkillArray[6]='AUcs'
    set mSkillArray[7]='Aamk'
    set mSkillArray[8]='Aamk'
    set mSkillArray[9]='Aamk'
    set mSkillArray[10]='A030'   //11
    set mSkillArray[11]='AUsl'
    set mSkillArray[12]='AUsl'
    set mSkillArray[13]='AUsl'
    set mSkillArray[14]='Aamk'
    set mSkillArray[15]='A030'  //16
    set mSkillArray[16]='Auhf'
    set mSkillArray[17]='Auhf'
    set mSkillArray[18]='Auhf'
    set mSkillArray[19]='Auhf'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_dianwei takes nothing returns nothing
    set mSkillArray[0]='A04W'  //t
    set mSkillArray[1]='A03R'  //d
    set mSkillArray[2]='A04W'  //
    set mSkillArray[3]='A03R'  //
    set mSkillArray[4]='A04W'
    set mSkillArray[5]='A00L'     //6
    set mSkillArray[6]='A04W'
    set mSkillArray[7]='A03R'
    set mSkillArray[8]='A03R'
    set mSkillArray[9]='A06D'
    set mSkillArray[10]='A00L'   //11
    set mSkillArray[11]='A06D'
    set mSkillArray[12]='A06D'
    set mSkillArray[13]='A06D'
    set mSkillArray[14]='Aamk'
    set mSkillArray[15]='A00L'  //16
    set mSkillArray[16]='Aamk'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction
function initSkillArry_xun takes nothing returns nothing
    set mSkillArray[0]='A060'  //t
    set mSkillArray[1]='A02E'  //d
    set mSkillArray[2]='A060'  //
    set mSkillArray[3]='Aamk'  //
    set mSkillArray[4]='A060'
    set mSkillArray[5]='A065'     //6
    set mSkillArray[6]='A060'
    set mSkillArray[7]='Aamk'
    set mSkillArray[8]='A02E'
    set mSkillArray[9]='A02E'
    set mSkillArray[10]='A065'   //11
    set mSkillArray[11]='A02E'
    set mSkillArray[12]='A0hw'
    set mSkillArray[13]='A0hw'
    set mSkillArray[14]='A0hw'
    set mSkillArray[15]='A065'  //16
    set mSkillArray[16]='A0hw'
    set mSkillArray[17]='Aamk'
    set mSkillArray[18]='Aamk'
    set mSkillArray[19]='Aamk'
    set mSkillArray[20]='Aamk'
    set mSkillArray[21]='Aamk'
    set mSkillArray[22]='Aamk'
    set mSkillArray[23]='Aamk'
    set mSkillArray[24]='Aamk'
    //return
endfunction

function initSkillArry takes nothing returns nothing
    if  mHeroId=='H008' then
        call  initSkillArry_zhugeliang()
    endif
    if  mHeroId=='U00A' then
        call  initSkillArry_simayi()
    endif
    
    if  mHeroId=='E000' then
        call  initSkillArry_zhaoyun()
    endif
    if  mHeroId=='H005' then
        call  initSkillArry_zhangliao()
    endif
    if isguojia() then
        call  initSkillArry_guojia()
    endif
    if isxun() then
        call  initSkillArry_xun()
    endif
    if iscaoren() then
        call  initSkillArry_caoren()
    endif
    if isdianwei() then
        call  initSkillArry_dianwei()
    endif
    if isguanyu() then
        call  initSkillArry_guanyu()
    endif
    if iszhangfei() then
        call  initSkillArry_zhangfei()
    endif
    if isweiyan() then
        call  initSkillArry_weiyan()
    endif
    
    //return
endfunction
